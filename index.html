<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Synthèse de Texte avec Gemini AI</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #eef2f6; /* Un fond clair et moderne */
            color: #334155;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            padding: 20px;
            box-sizing: border-box;
            flex-direction: column; /* Permet d'empiler les sections verticalement */
            overflow-x: hidden; /* Empêche le défilement horizontal */
            position: relative; /* Nécessaire pour positionner l'arrière-plan animé */
            z-index: 1; /* Assure que le contenu est au-dessus de l'arrière-plan */
        }

        /* Styles pour le spinner de chargement */
        .spinner {
            border: 4px solid rgba(0, 0, 0, 0.1);
            border-left-color: #8b5cf6; /* Couleur violette */
            border-radius: 50%;
            width: 24px;
            height: 24px;
            animation: spin 1s linear infinite;
            display: inline-block;
            vertical-align: middle;
            margin-right: 8px;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Styles pour les animations au scroll */
        .animate-on-scroll {
            opacity: 0;
            transform: translateY(30px); /* Plus grand décalage initial */
            transition: opacity 0.8s ease-out, transform 0.8s ease-out; /* Transitions plus longues et douces */
        }

        .animate-on-scroll.is-visible {
            opacity: 1;
            transform: translateY(0);
        }

        /* Styles pour l'animation Gemini (logo) */
        @keyframes gemini-blob-1 {
            0%, 100% {
                transform: scale(1) translate(0, 0);
                border-radius: 60% 40% 30% 70% / 60% 30% 70% 40%;
                opacity: 0.7;
            }
            25% {
                transform: scale(1.1) translate(10px, -5px);
                border-radius: 40% 60% 70% 30% / 30% 70% 40% 60%;
                opacity: 0.8;
            }
            50% {
                transform: scale(1.05) translate(-10px, 5px);
                border-radius: 70% 30% 60% 40% / 70% 40% 30% 60%;
                opacity: 0.9;
            }
            75% {
                transform: scale(1.1) translate(5px, 10px);
                border-radius: 30% 70% 40% 60% / 40% 60% 30% 70%;
                opacity: 0.8;
            }
        }

        @keyframes gemini-blob-2 {
            0%, 100% {
                transform: scale(0.9) translate(0, 0);
                border-radius: 70% 30% 60% 40% / 40% 60% 30% 70%;
                opacity: 0.5;
            }
            25% {
                transform: scale(1) translate(-10px, 5px);
                border-radius: 30% 70% 40% 60% / 60% 40% 70% 30%;
                opacity: 0.6;
            }
            50% {
                transform: scale(0.95) translate(10px, -5px);
                border-radius: 60% 40% 30% 70% / 70% 30% 60% 40%;
                opacity: 0.7;
            }
            75% {
                transform: scale(1) translate(-5px, -10px);
                border-radius: 40% 60% 70% 30% / 30% 70% 40% 60%;
                opacity: 0.6;
            }
        }

        /* Initial state for Gemini animation container entry */
        #gemini-animation-container.initial-hidden {
            opacity: 0;
            transform: translateY(20px);
        }

        /* Transition for Gemini animation container when loaded */
        #gemini-animation-container {
            transition: opacity 1s ease-out, transform 1s ease-out; /* Apply transition here */
        }

        /* Styles pour l'arrière-plan animé Gemini */
        #animated-background {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            overflow: hidden;
            z-index: 0; /* Assure qu'il est en arrière-plan */
        }

        .bg-blob {
            position: absolute;
            border-radius: 50%;
            filter: blur(120px); /* Flou encore plus intense pour un effet gazeux plus doux */
            opacity: 0.3; /* Transparence légèrement augmentée pour être moins distrayant */
            animation-iteration-count: infinite;
            animation-direction: alternate;
            animation-timing-function: ease-in-out;
        }

        .bg-blob-1 {
            width: 700px; /* Taille légèrement augmentée */
            height: 700px;
            background: linear-gradient(135deg, #8B5CF6, #EC4899); /* Violet à Rose */
            top: -15%; /* Positionnement ajusté */
            left: -15%;
            animation: moveBlob1 20s infinite alternate ease-in-out; /* Durée plus longue pour un mouvement plus lent */
        }

        .bg-blob-2 {
            width: 800px; /* Taille légèrement augmentée */
            height: 800px;
            background: linear-gradient(45deg, #3B82F6, #10B981); /* Bleu à Vert */
            bottom: -20%; /* Positionnement ajusté */
            right: -20%;
            animation: moveBlob2 22s infinite alternate ease-in-out; /* Durée plus longue */
        }

        .bg-blob-3 {
            width: 600px; /* Taille légèrement augmentée */
            height: 600px;
            background: linear-gradient(90deg, #6366F1, #A855F7); /* Indigo à Violet */
            top: 25%; /* Positionnement ajusté */
            right: -10%;
            animation: moveBlob3 25s infinite alternate ease-in-out; /* Durée plus longue */
        }

        /* Keyframes améliorées pour des mouvements plus dynamiques */
        @keyframes moveBlob1 {
            0%, 100% { transform: translate(0, 0) scale(1); }
            25% { transform: translate(80px, 120px) scale(1.15); } /* Mouvement et échelle plus prononcés */
            50% { transform: translate(-50px, 100px) scale(1.05); }
            75% { transform: translate(100px, -80px) scale(1.1); }
        }

        @keyframes moveBlob2 {
            0%, 100% { transform: translate(0, 0) scale(1); }
            25% { transform: translate(-100px, -90px) scale(1.1); }
            50% { transform: translate(70px, -120px) scale(1.08); }
            75% { transform: translate(-80px, 50px) scale(1.12); }
        }

        @keyframes moveBlob3 {
            0%, 100% { transform: translate(0, 0) scale(1); }
            25% { transform: translate(-60px, 110px) scale(1.2); } /* Mouvement et échelle plus prononcés */
            50% { transform: translate(90px, -70px) scale(1.1); }
            75% { transform: translate(-110px, -40px) scale(1.18); }
        }
    </style>
</head>
<body>
    <div id="animated-background">
        <div class="bg-blob bg-blob-1"></div>
        <div class="bg-blob bg-blob-2"></div>
        <div class="bg-blob bg-blob-3"></div>
    </div>

    <div id="gemini-animation-container" class="relative w-48 h-48 mx-auto mb-12 flex items-center justify-center initial-hidden">
        <div class="absolute w-full h-full rounded-full bg-gradient-to-br from-purple-500 to-indigo-600 filter blur-xl opacity-70 animate-[gemini-blob-1_8s_ease-in-out_infinite_alternate]"></div>
        <div class="absolute w-full h-full rounded-full bg-gradient-to-br from-blue-400 to-green-500 filter blur-xl opacity-50 animate-[gemini-blob-2_8s_ease-in-out_infinite_alternate_2s]"></div>
        <div class="relative z-10 text-white text-5xl font-extrabold drop-shadow-lg">AI</div>
    </div>

    <div class="w-full max-w-2xl bg-white p-10 rounded-3xl shadow-2xl border border-gray-100 animate-on-scroll relative z-10">
        <h2 class="text-4xl font-extrabold text-blue-700 mb-6 text-center leading-tight drop-shadow-sm">
            Synthétisez du Texte avec Gemini AI ✨
        </h2>
        <p class="text-lg leading-relaxed mb-6 text-gray-600 text-center">
            Collez n'importe quel texte ci-dessous et je le résumerai pour vous. Idéal pour extraire l'essentiel d'un long document !
        </p>
        <div class="flex flex-col gap-4 mb-4">
            <textarea id="text-to-summarize-input" placeholder="Collez votre texte ici pour le résumer..."
                      class="flex-grow p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 text-lg h-40 resize-y"></textarea>
            <button id="summarize-text-btn" class="bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700 text-white font-bold py-3 px-6 rounded-lg shadow-md transition-all duration-300 transform hover:scale-105 flex items-center justify-center focus:outline-none focus:ring-4 focus:ring-blue-300">
                Synthétiser le Texte
            </button>
        </div>
        <div id="summary-loading" class="mt-4 text-center text-blue-600 hidden">
            <span class="spinner"></span> Synthèse en cours...
        </div>
        <div id="summarized-text-display" class="mt-4 p-4 bg-blue-50 rounded-lg text-gray-700 text-base border border-blue-200 hidden"></div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // Fonction asynchrone pour synthétiser du texte avec Gemini AI
            async function summarizeText() {
                const textInput = document.getElementById('text-to-summarize-input');
                const summaryDisplay = document.getElementById('summarized-text-display');
                const loadingDiv = document.getElementById('summary-loading');
                const summarizeButton = document.getElementById('summarize-text-btn');

                const text = textInput.value.trim();

                if (!text) {
                    summaryDisplay.innerHTML = '<p class="text-red-500">Veuillez coller du texte à synthétiser.</p>';
                    summaryDisplay.classList.remove('hidden');
                    return;
                }

                // Afficher le spinner de chargement et désactiver le bouton
                loadingDiv.classList.remove('hidden');
                summaryDisplay.classList.add('hidden');
                summaryDisplay.innerHTML = '';
                summarizeButton.disabled = true;
                summarizeButton.classList.add('opacity-50', 'cursor-not-allowed');

                let chatHistory = [];
                const prompt = `Synthétise le texte suivant de manière concise et claire, en extrayant les points clés. Le résumé doit être d'environ 3 à 5 phrases : "${text}"`;
                chatHistory.push({ role: "user", parts: [{ text: prompt }] });

                const payload = { contents: chatHistory };
                const apiKey = ""; // L'API Key sera fournie par l'environnement Canvas
                const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${apiKey}`;

                try {
                    const response = await fetch(apiUrl, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(payload)
                    });

                    if (!response.ok) {
                        const errorData = await response.json();
                        throw new Error(`Erreur API: ${response.status} - ${errorData.error.message || 'Unknown error'}`);
                    }

                    const result = await response.json();

                    if (result.candidates && result.candidates.length > 0 &&
                        result.candidates[0].content && result.candidates[0].content.parts &&
                        result.candidates[0].content.parts.length > 0) {
                        const text = result.candidates[0].content.parts[0].text;
                        summaryDisplay.innerHTML = `<p>${text}</p>`;
                        summaryDisplay.classList.remove('hidden');
                    } else {
                        summaryDisplay.innerHTML = '<p class="text-red-500">Impossible de générer la synthèse. Veuillez réessayer.</p>';
                        summaryDisplay.classList.remove('hidden');
                        console.error("Structure de réponse inattendue de l'API Gemini:", result);
                    }
                } catch (error) {
                    console.error("Erreur lors de la synthèse du texte:", error);
                    summaryDisplay.innerHTML = `<p class="text-red-500">Une erreur est survenue : ${error.message}. Veuillez réessayer.</p>`;
                    summaryDisplay.classList.remove('hidden');
                } finally {
                    loadingDiv.classList.add('hidden');
                    summarizeButton.disabled = false;
                    summarizeButton.classList.remove('opacity-50', 'cursor-not-allowed');
                }
            }

            // Attacher les écouteurs d'événements
            document.getElementById('summarize-text-btn').addEventListener('click', summarizeText);
            document.getElementById('text-to-summarize-input').addEventListener('keydown', (e) => {
                if ((e.ctrlKey || e.metaKey) && e.key === 'Enter') {
                    summarizeText();
                }
            });

            // --- Logique d'animation au scroll ---
            const animateElements = document.querySelectorAll('.animate-on-scroll');

            const observerOptions = {
                root: null, /* viewport comme racine */
                rootMargin: '0px',
                threshold: 0.1 /* L'élément est visible à 10% */
            };

            const observer = new IntersectionObserver((entries, observer) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        entry.target.classList.add('is-visible');
                        // Optionnel: arrêter d'observer une fois l'animation déclenchée
                        // observer.unobserve(entry.target);
                    } else {
                        // Optionnel: retirer la classe si l'élément n'est plus visible (pour re-déclencher au scroll up)
                        // entry.target.classList.remove('is-visible');
                    }
                });
            }, observerOptions);

            animateElements.forEach(element => {
                observer.observe(element);
            });

            // --- Logique d'animation d'entrée Gemini (logo) ---
            const geminiAnimationContainer = document.getElementById('gemini-animation-container');
            if (geminiAnimationContainer) {
                setTimeout(() => {
                    geminiAnimationContainer.classList.remove('initial-hidden');
                }, 300); /* Petit délai pour s'assurer que le CSS est bien parsé avant le déclenchement */
            }
        });
    </script>
</body>
</html>
